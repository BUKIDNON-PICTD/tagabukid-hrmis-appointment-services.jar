import com.rameses.annotations.*;
import com.rameses.common.*;
import com.rameses.services.extended.*;


class EtracsDashReportService
{
	@ActiveDB(value='dashboardreport', em='etracs22')
	def em;

	@Env
	def env;

	@Service('DateService')
	def dtSvc 

	@Service("SequenceService")
	def seqSvc;

	@Service("QueryService")
    def querySvc;
	
	@Service('NumberService')
    def numSvc  

	@ProxyMethod
	public def getRpudash(params){
		def dashrpu = em.getDashrputypecount()
		return dashrpu
	}

	// RPU Queries
	@ProxyMethod() 
	public def dashRPU(params) { 
		def data = [
			rpudash : em.getRPUType(),
			rpudashtype   : 	em.getDashrputypecount(),			
			rpudashtotalhr   : 	em.getTotalHr(),		
			rpudashtotalsqm  : 	em.getTotalSQM(),		
			rpudashtotalbmv  : 	em.getTotalBMV(),		
			rpudashtotalmv  : 	em.getTotalMV(),		
			rpudashtotalav  : 	em.getTotalAV()
		] 
		 
		data.rpudash.each{ 
			it.LGU =  it.LGU;
			it.BARANGAY =  it.BARANGAY;
			it.LAND =  it.LAND;
			it.BLDG =  it.BLDG;
			it.MISC =  it.MISC;
			it.MACH =  it.MACH;
			it.PLANTTREE =  it.PLANTTREE;
		}

		data.rpudashtotalhr.each{
			it.LGU =  it.LGU;
			it.LAND =  numSvc.format('#,##0.00', it.LAND);
			it.BLDG =  numSvc.format('#,##0.00', it.BLDG);
			it.MISC =  numSvc.format('#,##0.00', it.MISC);
			it.MACH =  numSvc.format('#,##0.00', it.MACH);
			it.PLANTTREE =  numSvc.format('#,##0.00', it.PLANTTREE);
		}

		data.rpudashtotalbmv.each{
			it.LGU =  it.LGU;
			it.BARANGAY =  it.BARANGAY;
			it.LAND =  it.LAND;
			it.BLDG =  it.BLDG;
			it.MISC =  it.MISC;
			it.MACH =  it.MACH;
			it.PLANTTREE =  it.PLANTTREE;
		}
		 
		data.rpudashtotalmv.each{ 
			it.LGU =  it.LGU;
			it.BARANGAY =  it.BARANGAY;
			it.LAND =  it.LAND;
			it.BLDG =  it.BLDG;
			it.MISC =  it.MISC;
			it.MACH =  it.MACH;
			it.PLANTTREE =  it.PLANTTREE;
		}
		 
		data.rpudashtotalav.each{ 
			it.LGU =  it.LGU;
			it.BARANGAY =  it.BARANGAY;
			it.LAND =  it.LAND;
			it.BLDG =  it.BLDG;
			it.MISC =  it.MISC;
			it.MACH =  it.MACH;
			it.PLANTTREE =  it.PLANTTREE;
		}
		
		return data;
	} 
}
